# -----------------------------------------------------------------
# General options related to pipeline setup
# -----------------------------------------------------------------
max_cpus: 4  # max CPUs for any single job

scratch_dir: results/_scratch/  # put scratch files here

# -----------------------------------------------------------------
# Viral reference genomes
# -----------------------------------------------------------------

# align viral reads against this reference genome, which is constructed
# by adding to Wuhan-Hu-1 three mutations as described in
# https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7523107/
ref_genome:
  fasta: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.fna.gz
  gff: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/858/895/GCF_009858895.2_ASM985889v3/GCF_009858895.2_ASM985889v3_genomic.gff.gz
  name: proCoV2
  add_mutations: [C8782T, C18060T, T28144C]

# when mismatches, are they also present in these close-ish viral relatives?
# Note RaTG13 has highest overall identity, but according to
# https://www.biorxiv.org/content/10.1101/2021.01.22.427830v3.full,
# it is RmYN02, PrC31, and RpYN06 that are closest relatives after
# accounting for recombination.
comparator_genomes:
  RaTG13:
    gisaid: EPI_ISL_402131
  RmYN02:
    gisaid: EPI_ISL_412977
  PrC31:
    gisaid: EPI_ISL_1098866
  RpYN06:
    gisaid: EPI_ISL_1699446
# directories with GISAID augur format downloads of comparator genomes
gisaid_comparator_dirs:
  - data/comparator_genomes_gisaid

# early consensus sequences to align and include in analysis
early_sequences:
  gisaid:
    # subdirectories with GISAID augur format downloads
    gisaid_through_Feb2020: data/gisaid_sequences_through_Feb2020/

# -----------------------------------------------------------------
# General alignment and consensus / variant calling options
# -----------------------------------------------------------------
# short-read aligners to use
aligners:
  - minimap2
  - bwa-mem2

# in pileups, only consider sites where Q score >= this;
# also used for `fastp` preprocessing and `ivar` variant calling
minq: 20
# in `fastp` pre-processing require at least this read length
min_read_length: 20

# Criteria used to call consensus from pileup
consensus_min_coverage: 5  # require >= this coverage
consensus_min_frac: 0.8  # require most common base > this fraction

# report fraction viral genome covered at >= following depths
report_frac_coverage: [1, 2, 4, 10, 20, 50, 100]

# -----------------------------------------------------------------
# Parameters for final analysis
# -----------------------------------------------------------------
# focus on spike through ORF10, which is region fully sequenced in:
# https://www.medrxiv.org/content/10.1101/2020.03.04.20029538v1.full-text
region_of_interest:
  start: 21563
  end: 29674

# only work with samples with fractional coverage >= this
min_frac_coverage: 0.25

# Only compare to GISAID sequences isolated **before** this date
gisaid_last_date: 2020-03-01

# -----------------------------------------------------------------
# Samples on SRA to download using `fasterq-dump`
# -------------------------------------------------------------------
samples_fasterq_dump: {}

# -----------------------------------------------------------------
# Samples on SRA to download using `wget`
# -------------------------------------------------------------------
samples_wget:
  # -----------------------------------------------------------------
  # BioProject PRJNA612766, human samples
  # The samples commented out could not be downloaded even using wget
  # -----------------------------------------------------------------
  A1:
    accessions: ['SRR11313282', 'SRR11313334']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A2:
    accessions: ['SRR11313271', 'SRR11313461']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A4:
    accessions: ['SRR11313417', 'SRR11313428']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A6:
# sample SRR11313490 cannot be downloaded even using wget
#    accessions: ['SRR11313479', 'SRR11313490']
    accessions: ['SRR11313479']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A9:
    accessions: ['SRR11313345', 'SRR11313356']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A11:
    accessions: ['SRR11313455', 'SRR11313456']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  A12:
    accessions: ['SRR11313473', 'SRR11313474']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  B1:
    accessions: ['SRR11313453', 'SRR11313454']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  B2:
    accessions: ['SRR11313451', 'SRR11313452']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  B3:
    accessions: ['SRR11313448', 'SRR11313449']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  B4:
    accessions: ['SRR11313322', 'SRR11313333']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  B9:
    accessions: ['SRR11313445', 'SRR11313446']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  C1:
    accessions: ['SRR11313287', 'SRR11313289']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  C2:
    accessions: ['SRR11313285', 'SRR11313286']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  C9:
    accessions: ['SRR11313441', 'SRR11313442']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  C11:
    accessions: ['SRR11313300', 'SRR11313311']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  C12:
    accessions: ['SRR11313443', 'SRR11313444']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  D9:
    accessions: ['SRR11313436', 'SRR11313437']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  D11:
    accessions: ['SRR11313438', 'SRR11313440']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  D12:
    accessions: ['SRR11313280', 'SRR11313281']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E1:
    accessions: ['SRR11313276', 'SRR11313277']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E3:
    accessions: ['SRR11313430', 'SRR11313431']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E5:
    accessions: ['SRR11313274', 'SRR11313275']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E6:
    accessions: ['SRR11313427', 'SRR11313429']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E11:
    accessions: ['SRR11313434', 'SRR11313435']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  E12:
    accessions: ['SRR11313432', 'SRR11313433']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  F5:
    accessions: ['SRR11313270', 'SRR11313470']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  F8:
    accessions: ['SRR11313423', 'SRR11313424']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  F11:
    accessions: ['SRR11313425', 'SRR11313426']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  G1:
    accessions: ['SRR11313468', 'SRR11313469']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  G11:
    accessions: ['SRR11313421', 'SRR11313422']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  G12:
    accessions: ['SRR11313419', 'SRR11313420']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  H9:
    accessions: ['SRR11313464', 'SRR11313465']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  H12:
    accessions: ['SRR11313466', 'SRR11313467']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: early outpatient
  R01:
    accessions: ['SRR11313409', 'SRR11313410']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R02:
    accessions: ['SRR11313406', 'SRR11313408']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R03:
    accessions: ['SRR11313269', 'SRR11313471']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R04:
    accessions: ['SRR11313509']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R05:
    accessions: ['SRR11313507', 'SRR11313508']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R06:
    accessions: ['SRR11313505', 'SRR11313506']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R07:
    accessions: ['SRR11313503', 'SRR11313504']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R08:
    accessions: ['SRR11313500', 'SRR11313502']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R09:
# sample SRR11313499 cannot be downloaded even using wget
#    accessions: ['SRR11313498', 'SRR11313499']
    accessions: ['SRR11313498']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R10:
    accessions: ['SRR11313496', 'SRR11313497']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R11:
    accessions: ['SRR11313494', 'SRR11313495']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R12:
    accessions: ['SRR11313492', 'SRR11313493']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R13:
    accessions: ['SRR11313489', 'SRR11313491']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R14:
    accessions: ['SRR11313487', 'SRR11313488']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R15:
    accessions: ['SRR11313485', 'SRR11313486']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
  R16:
    accessions: ['SRR11313483', 'SRR11313484']
    collected_by: Renmin Hospital of Wuhan University
    patient_group: February hospitalized patient
